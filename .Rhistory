name <- as.character(deparse(quote(name)))
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
where(name, parent.env(env))
}
}
where(plot)
where <- function(name, env = globalenv()) {
#need to parse the name of a function into character
name <- as.character(substitute(name))
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
where(name, parent.env(env))
}
}
where(plot)
?get
get(plot)
deparse(quote(foo.bar))
deparse(quote(plot))
where <- function(name, env = globalenv()) {
#need to parse the name of a function into character
name <- deparse(quote(name))
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
where(name, parent.env(env))
}
}
where(plot)
where <- function(name, env = globalenv()) {
#need to parse the name of a function into character
name <- deparse(substitute(name))
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
where(name, parent.env(env))
}
}
where(plot)
deparse(substitute(plot))
where2 <- function(name, env = globalenv()) {
#need to parse the name of a function into character
name <- deparse(substitute(name))
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
where(name, parent.env(env))
}
}
where2(plot)
where2 <- function(name, env = globalenv()) {
#need to parse the name of a function into character
if (!is.character(name)) { name <- deparse(substitute(name)) }
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
where(name, parent.env(env))
}
}
where2(plot)
where2(plot)
where2 <- function(name, env = globalenv()) {
#need to parse the name of a function into character
if (!is.character(name)) { name <- deparse(substitute(name)) }
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
where(name, parent.env(env))
}
}
where2(plot)
where2 <- function(name, env = globalenv()) {
#need to parse the name of a function into character
if (!is.character(name)) { name <- deparse(substitute(name)) }
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
where2(name, parent.env(env))
}
}
where2(plot)
where <- function(name, env = globalenv()) {
#need to parse the name of a function into character
name <- deparse(substitute(name))
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
where(name, parent.env(env))
}
}
where(plot)
whereModified <- function(name, env = globalenv()) {
#need to parse the name of a function into character
name <- deparse(substitute(name))
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
whereModified(name, parent.env(env))
}
}
whereModified <- function(name, env = globalenv()) {
#need to parse the name of a function into character
name <- deparse(substitute(name))
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
whereModified(name, parent.env(env))
}
}
whereModified(plot)
whereModified <- function(name, env = globalenv()) {
#need to parse the name of a function into character
if (!is.character(name)) { name <- deparse(substitute(name)) }
if (identical(env, emptyenv())) {
# Base case
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
# Success case
environmentName(env)
} else {
# Recursive case
whereModified(name, parent.env(env))
}
}
whereModified(plot)
whereModified(start)
?get()
getModified <- function(name, env = parent.frame()) {
if (!is.character(name)) {
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
getModified(name, env = parent.env(env))
}
}
}
getModified(plot)
getModified <- function(name, env = parent.frame()) {
if (!is.character(name) & length(name)>0) {
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
getModified(name, env = parent.env(env))
}
}
}
getModified(plot)
getModified <- function(name, env = parent.frame()) {
if (!is.character(name) & length(name)==1) {
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
getModified(name, env = parent.env(env))
}
}
}
getModified(plot)
getModified <- function(name, env = parent.frame()) {
if (!is.character(name) & length(name)==1) {
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
getModified(name, env = parent.env(env))
}
}
}
getModified(plot)
getModified <- function(name, env = parent.frame()) {
if (!is.character(name) & length(name)==1) {
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
getModified(name, env = parent.env(env))
}
}
}
getModified(plot)
recursiveGet <- function(name, env = parent.frame()) {
stopifnot(is.character(name), length(name) == 1)
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
recursiveGet(name, env = parent.env(env))
}
}
recursiveGet(plot)
getModified <- function(name, env = parent.frame()) {
if (!is.character(name) & length(name)==1) {
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
getModified(name, env = parent.env(env))
}
}
}
getModified(plot)
getModified <- function(name, env = parent.frame()) {
stopifnot(is.character(name), length(name) == 1) {
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
getModified(name, env = parent.env(env))
}
}
}
getModified(plot)
getModified <- function(name, env = parent.frame()) {
stopifnot(is.character(name), length(name) == 1)
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
getModified(name, env = parent.env(env))
}
}
getModified(plot)
is.character(plot)
is.character(plot)==TRUE
is.character(plot)=TRUE
getModified <- function(name, env = parent.frame()) {
if (!is.character(name)) { name <- deparse(substitute(name)) }
if (identical(env, emptyenv())) {
# base case
warning(paste(name," not found"))
NULL
} else if (is.element(name,ls(env))) {
# success case
env[[name]]
} else {
# recursive case
getModified(name, env = parent.env(env))
}
}
getModified(plot)
fget(name, env, inherits = TRUE) {
if (!is.character(name)) { name <- deparse(substitute(name)) }
test <- function(env,name) is.element(name,ls(env)) && is.function(env[[`name`]])
if (test(env,name)) return(env[[`name`]])
if (isTRUE(inherits)) {
while (!identical(env,emptyenv())) {
env <- parent.env(env)
if (test(env,name)) return(env[[`name`]])
}
}
warning(paste(name," not found"))
NULL
}
fget<- function(name, env, inherits = TRUE) {
if (!is.character(name)) { name <- deparse(substitute(name)) }
test <- function(env,name) is.element(name,ls(env)) && is.function(env[[`name`]])
if (test(env,name)) return(env[[`name`]])
if (isTRUE(inherits)) {
while (!identical(env,emptyenv())) {
env <- parent.env(env)
if (test(env,name)) return(env[[`name`]])
}
}
warning(paste(name," not found"))
NULL
}
fget('mean',globalenv())
fget('start',globalenv())
existsModified<- function(name, env = parent.frame(), inherits = FALSE) {
if (!is.character(name)) { name <- deparse(substitute(name)) }
if (!inherits) return(name %in% ls(env))
if (identical(env, emptyenv())) {
# base case
FALSE
} else if (name %in% ls(env)) {
# success case
TRUE
} else {
# recursive case
existsModified(name, env = parent.env(env), inherits = TRUE)
}
}
myExists('start')
existsModified('start')
existsModified('get')
existsModified('fget')
strModified<- function(name) {
list(
name = deparse(substitute(name))
callEnviron = parent.frame()
enclosEnviron = parent.env(environment())
)
}
strModified<- function(name) {
list(
name = deparse(substitute(name)),
callEnviron = parent.frame(),
enclosEnviron = parent.env(environment())
)
}
myStr(var)
strModified(var)
strModified(plot)
strModified(plot)
strModified<- function(name) {
list(
name = deparse(substitute(name)),
callEnviron = parent.frame(name),
enclosEnviron = parent.env(environment(name))
)
}
strModified(plot)
strModified<- function(name) {
name = deparse(substitute(name))
list(
functionname = name,
callEnviron = parent.frame(),
enclosEnviron = parent.env(environment())
)
}
strModified(var)
strModified<- function(name) {
name = deparse(substitute(name))
list(
functionname = name,
callEnviron = parent.frame(name),
enclosEnviron = parent.env(environment())
)
}
strModified(var)
strModified<- function(name) {
name <- deparse(substitute(name))
list(
functionname = name,
callEnviron = parent.frame(name),
enclosEnviron = parent.env(environment())
)
}
strModified(var)
parent.frame(var)
?parent.frame
strModified<- function(name) {
name <- deparse(substitute(name))
list(
functionname = name,
callEnviron = get("name", parent.frame()),
enclosEnviron = get("name", environment())
)
}
strModified(var)
strModified<- function(name) {
name <- deparse(substitute(name))
list(
functionname = name,
callEnviron = get(name, parent.frame()),
enclosEnviron = get(name, environment())
)
}
strModified(var)
strModified(mean)
strModified<- function(name) {
name <- deparse(substitute(name))
list(
functionname = name,
callEnviron = get(name, parent.frame()),
enclosEnviron = get(name, parent.env(environment()))
)
}
strModified(mean)
strModified(mean)
strModified<- function(name) {
name <- deparse(substitute(name))
list(
functionname = name,
callEnviron = parent.frame(),
enclosEnviron = get(name, parent.env(environment()))
)
}
strModified(mean)
?Reserved
rebind <- function(name, value, env = parent.frame()) {
if (identical(env, emptyenv())) {
stop("Can't find ", name, call. = FALSE)
} else if (exists(name, envir = env, inherits = FALSE)) {
assign(name, value, envir = env)
} else {
rebind(name, value, parent.env(env))
}
}
rebind("a", 10)
assignModified<- function(name, value, env = parent.frame()) {
if (exists(name, envir = env, inherits = FALSE)) {
stop("Name already exists ", name, call. = FALSE)
} else {
assign(name, value, env)
}
}
assignModified("a", 2)
a
assignModified("a", 3)
assignModified<- function(name, value, env = parent.frame()) {
if (exists(name, envir = env, inherits = FALSE)) {
stop("Name already exists ", call. = FALSE)
} else {
assign(name, value, env)
}
}
